<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KING Store Ultimate</title>

<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="style.css">

<styleI need to actually use the edit_file tool in my response. Let me add the style.css link to index>
body { background:#f8fafc; }

/* CARD */
.menu-card {
    background:white;
    border-radius:20px;
    overflow:hidden;
    box-shadow:0 4px 20px rgba(0,0,0,0.05);
    transition:.3s;
}
.menu-card:hover {
    transform:translateY(-6px);
    box-shadow:0 10px 30px rgba(0,0,0,0.1);
}

.menu-image {
    width:100%;
    height:180px;
    object-fit:cover;
    opacity:0;
    transition:.4s;
}
.menu-image.loaded { opacity:1; }

/* skeleton */
.skeleton {
    background:linear-gradient(90deg,#eee 25%,#ddd 50%,#eee 75%);
    background-size:200% 100%;
    animation: shimmer 1.5s infinite;
}
@keyframes shimmer {
    0%{background-position:-200% 0;}
    100%{background-position:200% 0;}
}
</style>
</head>

<body class="min-h-screen">

<!-- HEADER -->
<div class="bg-white shadow-sm sticky top-0 z-50">
<div class="max-w-6xl mx-auto flex justify-between items-center p-4">
<h1 class="text-xl font-bold">üëë KING Store</h1>
<div class="flex gap-2">
<button onclick="switchView('buyer')" class="px-4 py-2 bg-black text-white rounded-xl text-sm">Buyer</button>
<button onclick="switchView('seller')" class="px-4 py-2 bg-gray-200 rounded-xl text-sm">Seller</button>
</div>
</div>
</div>

<!-- BUYER VIEW -->
<div id="buyer-view" class="max-w-6xl mx-auto p-5">

<!-- CATEGORY FILTERS -->
<div id="category-container" class="flex gap-2 overflow-x-auto pb-4 mb-4 no-scrollbar">
</div>

<!-- SEARCH -->
<div class="mb-6">
<input id="searchInput" type="text" placeholder="Search food..."
class="w-full p-3 border rounded-xl"
oninput="searchMenu()">
</div>

<!-- MENU GRID -->
<div id="menu-container"
class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
</div>

<!-- CART -->
<div class="fixed bottom-6 right-6">
<button onclick="toggleCart()"
class="bg-black text-white px-5 py-3 rounded-full shadow-lg">
üõí <span id="cart-count">0</span>
</button>
</div>

<!-- CART MODAL -->
<div id="cart-modal"
class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
<div class="bg-white w-96 p-6 rounded-2xl">
<h2 class="font-bold mb-4">Your Cart</h2>
<div id="cart-items"></div>
<div class="mt-4 font-bold">
Total: Rp <span id="cart-total">0</span>
</div>
<button onclick="checkout()"
class="mt-4 w-full bg-black text-white py-2 rounded-xl">
Checkout
</button>
<button onclick="toggleCart()"
class="mt-2 w-full bg-gray-200 py-2 rounded-xl">
Close
</button>
</div>
</div>

</div>

<!-- SELLER VIEW -->
<div id="seller-view" class="hidden max-w-5xl mx-auto p-6">
<h2 class="text-xl font-bold mb-4">Incoming Orders</h2>
<div id="orders-list"></div>
</div>

<script src="script.js"></script>

<script>
/* ================= AUTO IMAGE ================= */
function getFoodImage(name){
return `https://source.unsplash.com/600x400/?${encodeURIComponent(name)},food`;
}

/* ================= CATEGORIES ================= */
const CATEGORIES = [
{ id: 'all', name: 'All', emoji: 'üçΩÔ∏è' },
{ id: 'soup', name: 'Soup', emoji: 'üç≤' },
{ id: 'fried rice', name: 'Fried Rice', emoji: 'üçõ' },
{ id: 'noodles', name: 'Noodles', emoji: 'üçú' },
{ id: 'satay', name: 'Satay', emoji: 'üç¢' },
{ id: 'steak', name: 'Steak', emoji: 'ü•©' },
{ id: 'burger', name: 'Burger', emoji: 'üçî' },
{ id: 'pizza', name: 'Pizza', emoji: 'üçï' },
{ id: 'rice', name: 'Rice', emoji: 'üçö' },
{ id: 'sweet', name: 'Dessert', emoji: 'üç∞' },
{ id: 'drink', name: 'Drinks', emoji: 'üßã' },
{ id: 'healthy', name: 'Healthy', emoji: 'ü•ó' },
{ id: 'snack', name: 'Snack', emoji: 'üçü' },
{ id: 'spicy', name: 'Spicy', emoji: 'üå∂Ô∏è' },
{ id: 'seafood', name: 'Seafood', emoji: 'ü¶ê' },
{ id: 'japanese', name: 'Japanese', emoji: 'üç±' },
{ id: 'korean', name: 'Korean', emoji: 'üç°' },
{ id: 'western', name: 'Western', emoji: 'üçî' },
{ id: 'premium', name: 'Premium', emoji: 'üëë' }
];

let activeCategory = 'all';
let searchQuery = '';

/* ================= RENDER CATEGORY BUTTONS ================= */
function renderCategories(){
const container = document.getElementById('category-container');
if(!container) return;

container.innerHTML = CATEGORIES.map(cat => `
<button onclick="filterByCategory('${cat.id}')"
class="category-btn px-4 py-2 rounded-full text-sm font-medium transition-all
${activeCategory === cat.id ? 'bg-black text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}"
data-category="${cat.id}">
${cat.emoji} ${cat.name}
</button>
`).join('');
}

/* ================= FILTER BY CATEGORY ================= */
function filterByCategory(category){
activeCategory = category;
renderCategories();
filterMenu();
}

/* ================= FILTER MENU ================= */
function filterMenu(){
let filtered = [...MENU];

// Apply category filter
if(activeCategory !== 'all'){
filtered = filtered.filter(item => 
item.cat && item.cat.includes(activeCategory)
);
}

// Apply search filter
if(searchQuery){
filtered = filtered.filter(item =>
item.name.toLowerCase().includes(searchQuery.toLowerCase())
);
}

renderMenu(filtered.slice(0,40));
}

/* ================= SEARCH ================= */
function searchMenu(){
searchQuery = document.getElementById("searchInput").value.toLowerCase();
filterMenu();
}

/* ================= RENDER MENU ================= */
function renderMenu(items){
const container=document.getElementById("menu-container");
container.innerHTML="";

// Empty state
if(items.length === 0){
container.innerHTML = `
<div class="col-span-full text-center py-12">
<div class="text-6xl mb-4">üîç</div>
<h3 class="text-xl font-bold text-gray-700 mb-2">Menu Tidak Ditemukan</h3>
<p class="text-gray-500">Coba cari dengan kata kunci lain atau pilih kategori lain</p>
</div>
`;
return;
}

items.forEach(item=>{
const card=document.createElement("div");
card.className="menu-card";

card.innerHTML=`
<div class="relative">
<div class="skeleton h-[180px] absolute w-full"></div>
<img data-src="${getFoodImage(item.name)}"
class="menu-image lazy-image">
${item.taste === 'spicy' ? '<span class="absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full">üå∂Ô∏è Pedas</span>' : ''}
${item.taste === 'sweet' ? '<span class="absolute top-2 right-2 bg-pink-500 text-white text-xs px-2 py-1 rounded-full">üç¨ Manis</span>' : ''}
</div>
<div class="p-4">
<h3 class="font-bold text-sm mb-2">${item.img} ${item.name}</h3>
<p class="text-orange-600 font-bold mb-3">
Rp ${item.price.toLocaleString()}
</p>
<div class="flex items-center gap-2">
<button onclick="addToCart(${item.id})"
class="flex-1 bg-black text-white py-2 rounded-xl text-sm hover:bg-gray-800 transition-colors">
Tambah üõí
</button>
</div>
</div>
`;

container.appendChild(card);
});

lazyLoad();
}

/* ================= LAZY LOAD ================= */
function lazyLoad(){
const images=document.querySelectorAll(".lazy-image");

const observer=new IntersectionObserver(entries=>{
entries.forEach(entry=>{
if(entry.isIntersecting){
const img=entry.target;
img.src=img.dataset.src;
img.onload=()=>{
img.classList.add("loaded");
img.previousElementSibling.remove();
};
observer.unobserve(img);
}
});
});

images.forEach(img=>observer.observe(img));
}

/* ================= TOAST NOTIFICATION ================= */
function showToast(message, type = 'success'){
const toast = document.createElement('div');
toast.className = `fixed top-20 left-1/2 transform -translate-x-1/2 z-50 px-6 py-3 rounded-xl shadow-lg animate-bounce-in text-white font-medium
${type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-black'}`;

toast.innerHTML = message;
document.body.appendChild(toast);

setTimeout(() => {
toast.classList.add('animate-fade-out');
setTimeout(() => toast.remove(), 300);
}, 2500);
}

/* ================= CART - Load from localStorage ================= */
function loadCart(){
const saved = localStorage.getItem('kingCart');
if(saved){
cart = JSON.parse(saved);
} else {
cart = [];
}
updateCartCount();
}

/* ================= CART - Save to localStorage ================= */
function saveCart(){
localStorage.setItem('kingCart', JSON.stringify(cart));
updateCartCount();
}

/* ================= CART - Update count ================= */
function updateCartCount(){
const count = cart.reduce((sum, item) => sum + item.qty, 0);
document.getElementById("cart-count").innerText = count;
}

/* ================= ADD TO CART ================= */
function addToCart(id){
const item = MENU.find(m => m.id === id);
if(!item) return;

// Check if item already in cart
const existing = cart.find(c => c.id === id);
if(existing){
existing.qty += 1;
} else {
cart.push({...item, qty: 1});
}

saveCart();
showToast(`‚úÖ ${item.name} ditambahkan ke keranjang!`, 'success');
}

/* ================= UPDATE CART ================= */
function updateCart(){
const itemsDiv = document.getElementById("cart-items");

if(cart.length === 0){
itemsDiv.innerHTML = `
<div class="text-center py-8">
<div class="text-5xl mb-3">üõí</div>
<p class="text-gray-500">Keranjang masih kosong</p>
<p class="text-sm text-gray-400">Yuk, pesan makanan favoritmu!</p>
</div>
`;
document.getElementById("cart-total").innerText = "0";
return;
}

let total = 0;
itemsDiv.innerHTML = cart.map((item, index) => {
total += item.finalPrice * item.qty;
return `
<div class="flex items-center justify-between border-b py-3">
<div class="flex-1">
<div class="font-medium text-sm">${item.img} ${item.name}</div>
<div class="text-xs text-gray-500">${item.seller || 'KING Store'}</div>
<div class="text-orange-600 font-bold text-sm">Rp ${(item.finalPrice || item.price).toLocaleString()}</div>
</div>
<div class="flex items-center gap-2">
<button onclick="updateItemQty(${index}, -1)" class="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center">‚àí</button>
<span class="w-8 text-center font-bold">${item.qty}</span>
<button onclick="updateItemQty(${index}, 1)" class="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center">+</button>
<button onclick="removeFromCart(${index})" class="ml-2 text-red-500 hover:text-red-700">üóëÔ∏è</button>
</div>
</div>
`;
}).join('');

document.getElementById("cart-total").innerText = total.toLocaleString();
}

/* ================= UPDATE ITEM QUANTITY ================= */
function updateItemQty(index, delta){
cart[index].qty += delta;
if(cart[index].qty <= 0){
cart.splice(index, 1);
}
saveCart();
updateCart();
}

/* ================= REMOVE FROM CART ================= */
function removeFromCart(index){
const item = cart[index];
cart.splice(index, 1);
saveCart();
updateCart();
showToast(`üóëÔ∏è ${item.name} dihapus dari keranjang`, 'info');
}

/* ================= TOGGLE CART ================= */
function toggleCart(){
document.getElementById("cart-modal")
.classList.toggle("hidden");
}

/* ================= CHECKOUT ================= */
function checkout(){
if(cart.length === 0) return;

let subtotal = cart.reduce((s, i) => s + (i.finalPrice || i.price) * i.qty, 0);
let discount = 0;

if(cart.length >= 5) discount += 0.1;
if(subtotal > 500000) discount += 0.05;

let finalTotal = subtotal - subtotal * discount;

const order = {
id: Date.now(),
items: [...cart],
subtotal: subtotal,
discount: discount,
total: finalTotal,
date: new Date().toISOString()
};

orders.unshift(order);
localStorage.setItem("orders", JSON.stringify(orders));

cart = [];
saveCart();
updateCart();
toggleCart();
renderOrders();

const discountMsg = discount > 0 ? `\nüéâ Diskon ${Math.round(discount * 100)}% applied!` : '';
alert(`‚úÖ Pesanan berhasil!${discountMsg}\nüí∞ Total: Rp ${finalTotal.toLocaleString()}`);
}

/* ================= VIEW SWITCH ================= */
function switchView(view){
document.getElementById("buyer-view")
.classList.toggle("hidden", view !== "buyer");
document.getElementById("seller-view")
.classList.toggle("hidden", view !== "seller");

// Update button styles
const buyerBtn = document.querySelector('button[onclick="switchView(\'buyer\')"]');
const sellerBtn = document.querySelector('button[onclick="switchView(\'seller\')"]');

if(view === 'buyer'){
buyerBtn.classList.remove('bg-gray-200');
buyerBtn.classList.add('bg-black', 'text-white');
sellerBtn.classList.remove('bg-black', 'text-white');
sellerBtn.classList.add('bg-gray-200');
} else {
sellerBtn.classList.remove('bg-gray-200');
sellerBtn.classList.add('bg-black', 'text-white');
buyerBtn.classList.remove('bg-black', 'text-white');
buyerBtn.classList.add('bg-gray-200');
}

if(view === 'seller'){
renderOrders();
}
}

/* ================= RENDER ORDERS ================= */
function renderOrders(){
const list = document.getElementById("orders-list");

if(orders.length === 0){
list.innerHTML = `
<div class="text-center py-12">
<div class="text-6xl mb-4">üì≠</div>
<h3 class="text-xl font-bold text-gray-700 mb-2">Belum Ada Pesanan</h3>
<p class="text-gray-500">Pesanan akan muncul di sini</p>
</div>
`;
return;
}

list.innerHTML = orders.map(o => `
<div class="bg-white p-4 rounded-xl shadow mb-3">
<div class="flex justify-between items-start mb-2">
<div class="text-sm font-bold">
Order #${o.id.toString().slice(-4)}
</div>
<div class="text-xs text-gray-400">
${new Date(o.date).toLocaleDateString('id-ID')}
</div>
</div>
<div class="text-xs text-gray-600 mb-2">
${o.items.map(i => `${i.qty}x ${i.name}`).join(', ')}
</div>
${o.discount > 0 ? `<div class="text-xs text-green-600">üéâ Diskon ${Math.round(o.discount * 100)}%</div>` : ''}
<div class="font-bold text-orange-600">
Rp ${o.total.toLocaleString()}
</div>
</div>
`).join('');
}

/* ================= INIT ================= */
// Load cart from localStorage
loadCart();

// Render categories
renderCategories();

// Render initial menu
filterMenu();

</script>
</body>
</html>